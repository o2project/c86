[[git-rebase]]

== 作業履歴を改変する

作業履歴を改変するコマンドです。

例として、電話レンジ(仮)を改造してタイムリープマシンができた後、萌郁やラウンダー達の襲撃により、まゆりが殺されてしまった後の作業履歴を示します。

image::img/git-rebase/git-rebase-message-edit-before.png[まゆりが何度も死んでしまった時の作業履歴, 460]

=== コミットメッセージを変更する

では初めに、コミットメッセージを変更します。先ほどの作業履歴のうち、一番上で「ラウンダー追ってきて」と、間に「が」が足りないメッセージになってしまっています。これを修正します。そのためにまずは以下のコマンドを実行します。

image::img/git-rebase/git-rebase-message-edit-select.png[対話形式でリベースを選択している状態, 460]

すると以下の画面が表示されます。ここで「pick」となっているところを、「reword」に変更します。

image::img/git-rebase/git-rebase-message-edit-now.png[コミットメッセージを編集している状態, 460]

すると、コミットメッセージを編集できます。ここでは「が」を付け加えて保存します。

image::img/git-rebase/git-reset-message-edit-after.png[コミットメッセージを編集し終えた状態, 460]

=== 複数の作業履歴を一つにまとめる

次に、まゆりが死んだという複数の履歴を一つにまとめます。一つにまとめるには上記の作業履歴の状態の場合、以下のコマンドのどちらかを実行します。

image::img/git-rebase/git-rebase-squash-right-click.png[git rebase squashするべく親となるコミットを選択している状態, 460]

image::img/git-rebase/git-rebase-squash-before.png[git rebase squashしようとしている状態, 460]

Squash with previousを3回押します。その後Edit messageを押します。

image::img/git-rebase/git-rebase-squash-message-edit.png[コミットをまとめた後コミットメッセージを編集している状態, 460]


これにより、改めて`git log`で作業履歴を表示すると、以下のように表示されると思います。

image::img/git-rebase/git-rebase-squash-after.png[git rebase squashした状態, 460]
